<!DOCTYPE html>
<head>
  
  <!-- Google Tag Manager -->
  <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-PPZPQ6');</script>
  <!-- End Google Tag Manager -->
    <title>Exercise 1.7: Using the bigip_config module</title>
  

  <meta charset="utf-8">
  <!-- Twitter Bootstrap viewport setting -->
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <!-- F5 metadata -->
  <meta name="title" content="Exercise 1.7: Using the bigip_config module"/>
  <meta name="product" content="F5 Solutions for Containers"/>
  <meta name="version" content=""/>
  <meta name="updated_date"  content="2020-02-26 07:28:24"/>
  <meta name="archived" content="Archived documents excluded"/>
  <meta name="doc_type" content="Manual"/>
  <meta name="lifecycle" content="release"/>
  <meta name="F5 Solutions for Containers" content=""/>


  

  
  <link href="https://cdn.f5.com/favicon.ico" rel="icon">

</head>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Exercise 1.7: Using the bigip_config module &#8212; F5 Solutions for Containers  documentation</title>
    <link rel="stylesheet" href="../../_static/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/f5_agility_theme.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/bootstrap.min.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/f5.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/f5-theme.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/CoveoFullSearch.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/custom.css" />
    <link rel="stylesheet" type="text/css" href="https://use.fontawesome.com/21fb8a09c3.css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/language_data.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Section 2 - Ansible F5 Operational/Advanced Exercises" href="../module2/module2.html" />
    <link rel="prev" title="Exercise 1.6: Using the bigip_irule module" href="1.6-add-irules.html" /> 
  </head><body>
  <div id="clouddocs-header"></div>

    <div id="sidebar" class="section-nav">
      
      <!--  version selector ------------------>
      <div id="version_selector_wrapper">
      </div>
      <nav class="nav-sidebartoc">

        
         <h5>F5 Solutions for Containers  </h5>
        

        <hr>
        <span class="nav-sidebartoc">
            <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../class01/class01.html">Class 1: Programmability - Introduction to BIG-IP Rest Structure and Concepts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../class02/class02.html">Class 2: A&amp;O Toolchain 111: BIG-IP Deployments with Declarative Onboarding (DO)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../class03/class03.html">Class 3: Application Deployments with BIG-IP and Application Services (AS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../class04/class04.html">Class 4: A&amp;O Tool Chain - BIG-IP Service Analytics and Metrics with Telemetry Streaming (TS)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../class05/class05.html">Class 5: A&amp;O Tool Chain - Advanced Design Patterns with AS3, DO and TS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../class06/class06.html">Class 6: Programmability - CI/CD Process Integration with BIG-IP</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../class07/class07.html">Class 7: Dude Where's My Services: Introduction to Service Discovery with Consul</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../class08/class08.html">Class 8: Containers - Kubernetes &amp; OpenShift Integration with BIG-IP</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../class09.html">Class 9: Basic BIG-IP Configuration Management with Ansible</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../class10/class10.html">Class 10: Advanced BIG-IP Configuration Management with Ansible</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../class11/class11.html">Class 11: 101 of Terraform BIG-IP Provider</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../class12/class12.html">Class 12: Cisco ACI Integration with BIG-IP</a></li>
</ul>

        </span><!-- Use this file to add extra links to the bottom of the ToC sidebar -->
<hr>
  <span class="nav-sidebartoc">
 <!-- insert content here -->
  </span>
      </nav>
    </div>


    <div id="right-sidebar">
      <h7 style="font-weight:normal">On this page:</h7>
      <nav class="nav-sidebartoc">
        <span class="nav-sidebartoc">
            <ul>
<li><a class="reference internal" href="#">Exercise 1.7: Using the bigip_config module</a><ul>
<li><a class="reference internal" href="#objective">Objective</a></li>
<li><a class="reference internal" href="#guide">Guide</a><ul>
<li><a class="reference internal" href="#step-1">Step 1:</a></li>
<li><a class="reference internal" href="#step-2">Step 2:</a></li>
<li><a class="reference internal" href="#step-3">Step 3</a></li>
<li><a class="reference internal" href="#step-4">Step 4</a></li>
</ul>
</li>
<li><a class="reference internal" href="#playbook-output">Playbook Output</a></li>
<li><a class="reference internal" href="#solution">Solution</a></li>
</ul>
</li>
</ul>

         </span>
      </nav>
    </div>





  
  <div class="main active" id="content" >
    <article class="docs-container site-article-inner">
              <!-- custom breadcrumb -->
        <h5>
            <a href="../../index.html">F5 Solutions for Containers</a>
              &gt; <a href="../class09.html">Class 9: Basic BIG-IP Configuration Management with Ansible</a>
              &gt; <a href="module1.html">Section 1 - Ansible F5 Basic Exercises</a>

          <span class="right">
             <a href="../../_sources/class09/module1/1.7-save-running-config.rst.txt" rel="nofollow">Source</a> |
          </span>
        </h5>
        <!-- end custom breadcrumb -->
      


    <!--a title="Export PDF" id="export-pdf" class="btn btn btn-link pull-right">View PDF</a-->
    <button type="button" id="export-pdf" class="btn btn-link right">PDF</button>


    
     
         <div class="sidebar" id="version-warning" style="display: none;">
           <p class="first sidebar-title">
           <span class="icon fa fa-info-circle fa-lg"></span> Version notice:</p>
           <p class="last" id="currentVersion"></p>
          </div>


     <div role="main">
        
  <div class="section" id="exercise-1-7-using-the-bigip-config-module">
<span id="save-running-config"></span><h1>Exercise 1.7: Using the bigip_config module<a class="headerlink" href="#exercise-1-7-using-the-bigip-config-module" title="Permalink to this headline">¶</a></h1>
<div class="section" id="objective">
<h2>Objective<a class="headerlink" href="#objective" title="Permalink to this headline">¶</a></h2>
<p>Demonstrate use of the <a class="reference external" href="https://docs.ansible.com/ansible/latest/modules/bigip_config_module.html">BIG-IP config
module</a>
to save the running configuration to disk</p>
</div>
<div class="section" id="guide">
<h2>Guide<a class="headerlink" href="#guide" title="Permalink to this headline">¶</a></h2>
<div class="section" id="step-1">
<h3>Step 1:<a class="headerlink" href="#step-1" title="Permalink to this headline">¶</a></h3>
<p>Using your text editor of choice create a new file called
<code class="docutils literal notranslate"><span class="pre">bigip-config.yml</span></code>.</p>
<div class="highlight-shell-session notranslate"><div class="highlight"><pre><span></span><span class="gp">[centos@ansible ~]$</span> nano bigip-config.yml
</pre></div>
</div>
<blockquote>
<div><code class="docutils literal notranslate"><span class="pre">vim</span></code> and <code class="docutils literal notranslate"><span class="pre">nano</span></code> are available on the control node, as well as
Visual Studio and Atom via RDP</div></blockquote>
</div>
<div class="section" id="step-2">
<h3>Step 2:<a class="headerlink" href="#step-2" title="Permalink to this headline">¶</a></h3>
<p>Ansible playbooks are <strong>YAML</strong> files. YAML is a structured encoding
format that is also extremely human readable (unlike it’s subset - the
JSON format).</p>
<p>Enter the following play definition into <code class="docutils literal notranslate"><span class="pre">bigip-virtual-server.yml</span></code>:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nn">---</span>
<span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">BIG-IP SETUP</span>
  <span class="nt">hosts</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">lb</span>
  <span class="nt">connection</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">local</span>
  <span class="nt">gather_facts</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">false</span>
</pre></div>
</div>
<ul class="simple">
<li>The <code class="docutils literal notranslate"><span class="pre">---</span></code> at the top of the file indicates that this is a YAML
file.</li>
<li>The <code class="docutils literal notranslate"><span class="pre">hosts:</span> <span class="pre">f5</span></code>, indicates the play is run only on the F5 BIG-IP
device</li>
<li><code class="docutils literal notranslate"><span class="pre">connection:</span> <span class="pre">local</span></code> tells the Playbook to run locally (rather than
SSHing to itself)</li>
<li><code class="docutils literal notranslate"><span class="pre">gather_facts:</span> <span class="pre">no</span></code> disables facts gathering. We are not using any
fact variables for this playbook.</li>
</ul>
<p>Do not exit the editor yet.</p>
</div>
<div class="section" id="step-3">
<h3>Step 3<a class="headerlink" href="#step-3" title="Permalink to this headline">¶</a></h3>
<p>Next, add the <code class="docutils literal notranslate"><span class="pre">task</span></code>. This task will use the <code class="docutils literal notranslate"><span class="pre">bigip-config</span></code> to save
the running configuration to disk</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">tasks</span><span class="p">:</span>

<span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">SAVE RUNNING CONFIG ON BIG-IP</span>
  <span class="nt">bigip_config</span><span class="p">:</span>
    <span class="nt">provider</span><span class="p">:</span>
      <span class="nt">server</span><span class="p">:</span> <span class="s">&quot;{{private_ip}}&quot;</span>
      <span class="nt">user</span><span class="p">:</span> <span class="s">&quot;{{ansible_user}}&quot;</span>
      <span class="nt">password</span><span class="p">:</span> <span class="s">&quot;{{ansible_ssh_pass}}&quot;</span>
      <span class="nt">server_port</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">8443</span>
      <span class="nt">validate_certs</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">no</span>
    <span class="nt">save</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">yes</span>
</pre></div>
</div>
<blockquote>
<div>A play is a list of tasks. Tasks and modules have a 1:1 correlation.
Ansible modules are reusable, standalone scripts that can be used by
the Ansible API, or by the ansible or ansible-playbook programs. They
return information to ansible by printing a JSON string to stdout
before exiting.</div></blockquote>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">name:</span> <span class="pre">SAVE</span> <span class="pre">RUNNING</span> <span class="pre">CONFIG</span> <span class="pre">ON</span> <span class="pre">BIG-IP</span></code> is a user defined description
that will display in the terminal output.</li>
<li><code class="docutils literal notranslate"><span class="pre">bigip_config:</span></code> tells the task which module to use.</li>
<li>The <code class="docutils literal notranslate"><span class="pre">server:</span> <span class="pre">&quot;{{private_ip}}&quot;</span></code> parameter tells the module to
connect to the F5 BIG-IP IP address, which is stored as a variable
<code class="docutils literal notranslate"><span class="pre">private_ip</span></code> in inventory</li>
<li>The <code class="docutils literal notranslate"><span class="pre">provider:</span></code> parameter is a group of connection details for the
BIG-IP.</li>
<li>The <code class="docutils literal notranslate"><span class="pre">user:</span> <span class="pre">&quot;{{ansible_user}}&quot;</span></code> parameter tells the module the
username to login to the F5 BIG-IP device with</li>
<li>The <code class="docutils literal notranslate"><span class="pre">password:</span> <span class="pre">&quot;{{ansible_ssh_pass}}&quot;</span></code> parameter tells the module
the password to login to the F5 BIG-IP device with</li>
<li>The <code class="docutils literal notranslate"><span class="pre">server_port:</span> <span class="pre">8443</span></code> parameter tells the module the port to
connect to the F5 BIG-IP device with</li>
<li>The <code class="docutils literal notranslate"><span class="pre">save:</span> <span class="pre">&quot;yes&quot;&quot;</span></code> parameter tells the module to save the
running-config to startup-config. This operation is performed after
any changes are made to the current running config. If no changes are
made, the configuration is
still saved to the startup config. This option will always cause the
module to return changed</li>
<li>The <code class="docutils literal notranslate"><span class="pre">validate_certs:</span> <span class="pre">&quot;no&quot;</span></code> parameter tells the module to not
validate SSL certificates. This is just used for demonstration
purposes since this is a lab.</li>
</ul>
<p>Save File and exit out of editor.</p>
</div>
<div class="section" id="step-4">
<h3>Step 4<a class="headerlink" href="#step-4" title="Permalink to this headline">¶</a></h3>
<p>Run the playbook - exit back into the command line of the control host
and execute the following:</p>
<div class="highlight-shell-session notranslate"><div class="highlight"><pre><span></span><span class="gp">[centos@ansible ~]$</span> ansible-playbook bigip-config.yml
</pre></div>
</div>
</div>
</div>
<div class="section" id="playbook-output">
<h2>Playbook Output<a class="headerlink" href="#playbook-output" title="Permalink to this headline">¶</a></h2>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">[</span><span class="nv">centos@ansible</span><span class="p p-Indicator">]</span><span class="l l-Scalar l-Scalar-Plain">$ ansible-playbook bigip-config.yml</span>

<span class="l l-Scalar l-Scalar-Plain">PLAY [BIG-IP SETUP] ************************************************************************************************************************</span>

<span class="l l-Scalar l-Scalar-Plain">TASK [SAVE RUNNING CONFIG ON BIG-IP] ************************************************************************************************************************</span>
<span class="l l-Scalar l-Scalar-Plain">changed</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">[</span><span class="nv">f5</span><span class="p p-Indicator">]</span>

<span class="l l-Scalar l-Scalar-Plain">PLAY RECAP *************************************************************************************************************</span>
<span class="nt">f5                         </span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ok=1    changed=1    unreachable=0    failed=0</span>
</pre></div>
</div>
</div>
<div class="section" id="solution">
<h2>Solution<a class="headerlink" href="#solution" title="Permalink to this headline">¶</a></h2>
<p>The finished Ansible Playbook is provided here for an Answer key. Click
here:
<a class="reference download internal" download="" href="../../_downloads/3f46557f0cd7bb63c563b96cc4516f9b/bigip-config.yml"><code class="xref download docutils literal notranslate"><span class="pre">bigip-config.yml</span></code></a>.</p>
<p>You have finished this exercise. <a class="reference external" href="..">Click here to return to the lab
guide</a></p>
</div>
</div>


     </div>
    
     <div class="row next-prev-btn-row">
       <div class="col-lg-12">
       
        <a href="1.6-add-irules.html" title="Exercise 1.6: Using the bigip_irule module" accesskey="p" class="btn btn-primary left"><i class="fa fa-arrow-circle-left" aria-hidden="true"></i> Previous</a>
       
       
          <a href="../module2/module2.html" title="Section 2 - Ansible F5 Operational/Advanced Exercises" accesskey="n" class="btn btn-primary right">Next <i class="fa fa-arrow-circle-right" aria-hidden="true"></i></a>
       
     </div>
     </div>
    

    </article>
  </div>

</div>


  <div id="clouddocs-footer"></div>
  <!-- Bootstrap core JavaScript
  ================================================== -->
  <!-- Placed at the end of the document so the pages load faster -->

  <script src="../../_static/js/index.js"></script>
  <script src="../../_static/js/jquery.appear.js"></script>
  <script src="../../_static/js/printThis.js"></script>
  <script src="../../_static/js/bootstrap.min.js"></script>
  <script src="../../_static/js/clouddocs.js"></script>
  <script src="../../_static/js/CoveoJsSearch.Lazy.min.js"></script>
  </body>
</html>